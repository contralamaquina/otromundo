<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Integrar Logo con IA</title>
</head>
<body>
  <h2>Subí tu logo y fondo</h2>

  <input type="file" id="logoInput" accept="image/*" /><br><br>
  <input type="file" id="fondoInput" accept="image/*" /><br><br>
  <button id="generarIA">Generar imagen con IA</button>

  <h3>Resultado:</h3>
  <img id="resultadoIA" style="max-width:100%; display:none; margin-top:1rem;" />

  <script>
    async function toBase64(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = () => resolve(reader.result.split(',')[1]);
        reader.onerror = reject;
        reader.readAsDataURL(file);
      });
    }

    document.getElementById("generarIA").addEventListener("click", async () => {
      const logoFile = document.getElementById("logoInput").files[0];
      const fondoFile = document.getElementById("fondoInput").files[0];

      if (!logoFile || !fondoFile) {
        alert("Subí ambas imágenes.");
        return;
      }

      const logoBase64 = await toBase64(logoFile);
      const fondoBase64 = await toBase64(fondoFile);

      try {
        const res = await fetch("https://aleotromundo.vercel.app/api/integrar-logo", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ logoBase64, fondoBase64 })
        });

        const data = await res.json();

        if (data.image) {
          const img = document.getElementById("resultadoIA");
          img.src = data.image;
          img.style.display = "block";
        } else {
          alert("No se generó la imagen.");
        }
      } catch (err) {
        console.error("Error al generar:", err);
        alert("Falló la integración.");
      }
    });
  </script>
</body>
</html>